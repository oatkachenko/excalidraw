var wo=Object.create;var sn=Object.defineProperty;var Io=Object.getOwnPropertyDescriptor;var To=Object.getOwnPropertyNames;var So=Object.getPrototypeOf,Lo=Object.prototype.hasOwnProperty;var Mo=(e,t)=>()=>(e&&(t=e(e=0)),t);var St=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var vo=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of To(t))!Lo.call(e,i)&&i!==n&&sn(e,i,{get:()=>t[i],enumerable:!(o=Io(t,i))||o.enumerable});return e};var Lt=(e,t,n)=>(n=e!=null?wo(So(e)):{},vo(t||!e||!e.__esModule?sn(n,"default",{value:e,enumerable:!0}):n,e));var g,p=Mo(()=>{g={PROD:!0}});var Pn=St((Gt,xn)=>{p();(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof Gt=="object"?xn.exports=t():(e.PromisePool=t(),e.promisePool=e.PromisePool)})(Gt,function(){"use strict";var e=function(){this._listeners={}};e.prototype.addEventListener=function(r,l){this._listeners[r]=this._listeners[r]||[],this._listeners[r].indexOf(l)<0&&this._listeners[r].push(l)},e.prototype.removeEventListener=function(r,l){if(this._listeners[r]){var c=this._listeners[r].indexOf(l);c>=0&&this._listeners[r].splice(c,1)}},e.prototype.dispatchEvent=function(r){if(this._listeners[r.type]&&this._listeners[r.type].length)for(var l=this._listeners[r.type].slice(),c=0,d=l.length;c<d;++c)l[c].call(this,r)};var t=function(r){return typeof r.constructor=="function"&&r.constructor.name==="GeneratorFunction"},n=function(r){return{next:function(){var l=r();return l?{value:l}:{done:!0}}}},o=function(r){var l=!1;return{next:function(){return l?{done:!0}:(l=!0,{value:r})}}},i=function(r,l){var c=typeof r;if(c==="object"){if(typeof r.next=="function")return r;if(typeof r.then=="function")return o(r)}return c==="function"?t(r)?r():n(r):o(l.resolve(r))},s=function(r,l,c){this.target=r,this.type=l,this.data=c},a=function(r,l,c){if(e.call(this),typeof l!="number"||Math.floor(l)!==l||l<1)throw new Error("Invalid concurrency");this._concurrency=l,this._options=c||{},this._options.promise=this._options.promise||Promise,this._iterator=i(r,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return a.prototype=new e,a.prototype.constructor=a,a.prototype.concurrency=function(r){return typeof r<"u"&&(this._concurrency=r,this.active()&&this._proceed()),this._concurrency},a.prototype.size=function(){return this._size},a.prototype.active=function(){return!!this._promise},a.prototype.promise=function(){return this._promise},a.prototype.start=function(){var r=this,l=this._options.promise;return this._promise=new l(function(c,d){r._callbacks={reject:d,resolve:c},r._proceed()}),this._promise},a.prototype._fireEvent=function(r,l){this.dispatchEvent(new s(this,r,l))},a.prototype._settle=function(r){r?this._callbacks.reject(r):this._callbacks.resolve(),this._promise=null,this._callbacks=null},a.prototype._onPooledPromiseFulfilled=function(r,l){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:r,result:l}),this._proceed())},a.prototype._onPooledPromiseRejected=function(r,l){this._size--,this.active()&&(this._fireEvent("rejected",{promise:r,error:l}),this._settle(l||new Error("Unknown error")))},a.prototype._trackPromise=function(r){var l=this;r.then(function(c){l._onPooledPromiseFulfilled(r,c)},function(c){l._onPooledPromiseRejected(r,c)}).catch(function(c){l._settle(new Error("Promise processing failed: "+c))})},a.prototype._proceed=function(){if(!this._done){for(var r={done:!1};this._size<this._concurrency&&!(r=this._iterator.next()).done;)this._size++,this._trackPromise(r.value);this._done=r===null||!!r.done}this._done&&this._size===0&&this._settle()},a.PromisePoolEvent=s,a.PromisePool=a,a})});var In=St(Je=>{"use strict";p();Object.defineProperty(Je,"__esModule",{value:!0});Je.sanitizeUrl=void 0;var Vo=/^([^\w]*)(javascript|data|vbscript)/im,Ko=/&#(\w+)(^\w|;)?/g,jo=/&(newline|tab);/gi,qo=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Zo=/^.+(:|&colon;)/gim,Qo=[".","/"];function Jo(e){return Qo.indexOf(e[0])>-1}function ei(e){return e.replace(Ko,function(t,n){return String.fromCharCode(n)})}function ti(e){var t=ei(e||"").replace(jo,"").replace(qo,"").trim();if(!t)return"about:blank";if(Jo(t))return t;var n=t.match(Zo);if(!n)return t;var o=n[0];return Vo.test(o)?"about:blank":t}Je.sanitizeUrl=ti});var Yn=St((Gd,zn)=>{p();var Un="Expected a function",kn=NaN,Ci="[object Symbol]",Di=/^\s+|\s+$/g,Ri=/^[-+]0x[0-9a-f]+$/i,Bi=/^0b[01]+$/i,Gi=/^0o[0-7]+$/i,Fi=parseInt,Oi=typeof global=="object"&&global&&global.Object===Object&&global,Ni=typeof self=="object"&&self&&self.Object===Object&&self,_i=Oi||Ni||Function("return this")(),ki=Object.prototype,Hi=ki.toString,Ui=Math.max,zi=Math.min,Vt=function(){return _i.Date.now()};function Yi(e,t,n){var o,i,s,a,r,l,c=0,d=!1,m=!1,f=!0;if(typeof e!="function")throw new TypeError(Un);t=Hn(t)||0,gt(n)&&(d=!!n.leading,m="maxWait"in n,s=m?Ui(Hn(n.maxWait)||0,t):s,f="trailing"in n?!!n.trailing:f);function u(M){var O=o,G=i;return o=i=void 0,c=M,a=e.apply(G,O),a}function h(M){return c=M,r=setTimeout(y,t),d?u(M):a}function E(M){var O=M-l,G=M-c,F=t-O;return m?zi(F,s-G):F}function P(M){var O=M-l,G=M-c;return l===void 0||O>=t||O<0||m&&G>=s}function y(){var M=Vt();if(P(M))return I(M);r=setTimeout(y,E(M))}function I(M){return r=void 0,f&&o?u(M):(o=i=void 0,a)}function H(){r!==void 0&&clearTimeout(r),c=0,o=l=i=r=void 0}function J(){return r===void 0?a:I(Vt())}function C(){var M=Vt(),O=P(M);if(o=arguments,i=this,l=M,O){if(r===void 0)return h(l);if(m)return r=setTimeout(y,t),u(l)}return r===void 0&&(r=setTimeout(y,t)),a}return C.cancel=H,C.flush=J,C}function Wi(e,t,n){var o=!0,i=!0;if(typeof e!="function")throw new TypeError(Un);return gt(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),Yi(e,t,{leading:o,maxWait:t,trailing:i})}function gt(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Xi(e){return!!e&&typeof e=="object"}function $i(e){return typeof e=="symbol"||Xi(e)&&Hi.call(e)==Ci}function Hn(e){if(typeof e=="number")return e;if($i(e))return kn;if(gt(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=gt(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Di,"");var n=Bi.test(e);return n||Gi.test(e)?Fi(e.slice(2),n?2:8):Ri.test(e)?kn:+e}zn.exports=Wi});p();p();p();p();p();var an={white:"#ffffff",black:"#000000",gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]};var Do=(e,t)=>t.reduce((n,o)=>(o in e&&(n[o]=e[o]),n),{});var Ke=4,je=1,V=[0,2,4,6,8];var K=(e,t)=>t.map(n=>an[e][n]),S={transparent:"transparent",black:"#1e1e1e",white:"#ffffff",gray:K("gray",V),red:K("red",V),pink:K("pink",V),grape:K("grape",V),violet:K("violet",V),blue:K("blue",V),cyan:K("cyan",V),teal:K("teal",V),green:K("green",V),yellow:K("yellow",V),orange:K("orange",V),bronze:["#f8f1ee","#eaddd7","#d2bab0","#a18072","#846358"]},ln=Do(S,["cyan","blue","violet","grape","pink","green","teal","yellow","orange","red"]),Hr=[S.black,S.red[Ke],S.green[Ke],S.blue[Ke],S.yellow[Ke]],Ur=[S.transparent,S.red[je],S.green[je],S.blue[je],S.yellow[je]],zr=[S.white,"#f8f9fa","#f5faff","#fffce8","#fdf8f6"],Yr={transparent:S.transparent,white:S.white,gray:S.gray,black:S.black,bronze:S.bronze,...ln},Wr={transparent:S.transparent,white:S.white,gray:S.gray,black:S.black,bronze:S.bronze,...ln};p();var Mt=/Mac|iPod|iPhone|iPad/.test(navigator.platform),Kr=/^Win/.test(navigator.platform),jr=/\b(android)\b/i.test(navigator.userAgent),qr="netscape"in window&&navigator.userAgent.indexOf("rv:")>1&&navigator.userAgent.indexOf("Gecko")>1,Ro=navigator.userAgent.indexOf("Chrome")!==-1,Zr=!Ro&&navigator.userAgent.indexOf("Safari")!==-1,Qr=/iPad|iPhone/.test(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document;var Jr=typeof window<"u"&&"ResizeObserver"in window;var cn=8;var Bo=Math.PI/12;var vt={TEST:"test",DEVELOPMENT:"development"};var Go="Xiaolai",dn="Segoe UI Emoji",j={Virgil:1,Helvetica:2,Cascadia:3,Excalifont:5,Nunito:6,"Lilita One":7,"Comic Shanns":8,"Liberation Sans":9},At={[Go]:100,[dn]:1e3};var Fo=j.Excalifont;var Oo=2,No=2*Oo,_o=1e-5,es=2*No-_o;var un={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},ve={text:"text/plain",html:"text/html",json:"application/json",excalidraw:"application/vnd.excalidraw+json",excalidrawlib:"application/vnd.excalidrawlib+json","excalidraw.svg":"image/svg+xml","excalidraw.png":"image/png",binary:"application/octet-stream",...un},ts=[ve.text,ve.html,...Object.values(un)];var ns=window.EXCALIDRAW_EXPORT_SOURCE||window.location.origin;var os=4*1024*1024;var qe=.25,pn=32,Ae={LEGACY:1,PROPORTIONAL_RADIUS:2,ADAPTIVE_RADIUS:3},Ct={architect:0,artist:1,cartoonist:2};var is={strokeColor:S.black,backgroundColor:S.transparent,fillStyle:"solid",strokeWidth:2,strokeStyle:"solid",roughness:Ct.artist,opacity:100,locked:!1};var rs=Symbol.for("__test__originalId__");p();var cs={[j.Excalifont]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25}},[j.Nunito]:{metrics:{unitsPerEm:1e3,ascender:1011,descender:-353,lineHeight:1.35}},[j["Lilita One"]]:{metrics:{unitsPerEm:1e3,ascender:923,descender:-220,lineHeight:1.15}},[j["Comic Shanns"]]:{metrics:{unitsPerEm:1e3,ascender:750,descender:-250,lineHeight:1.25}},[j.Virgil]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},deprecated:!0},[j.Helvetica]:{metrics:{unitsPerEm:2048,ascender:1577,descender:-471,lineHeight:1.15},deprecated:!0,local:!0},[j.Cascadia]:{metrics:{unitsPerEm:2048,ascender:1900,descender:-480,lineHeight:1.2},deprecated:!0},[j["Liberation Sans"]]:{metrics:{unitsPerEm:2048,ascender:1854,descender:-434,lineHeight:1.15},serverSide:!0},[At.Xiaolai]:{metrics:{unitsPerEm:1e3,ascender:880,descender:-144,lineHeight:1.15},fallback:!0},[At["Segoe UI Emoji"]]:{metrics:{unitsPerEm:1e3,ascender:886,descender:-374,lineHeight:1.25},local:!0,fallback:!0}};p();p();var mn={EQUAL:"Equal",MINUS:"Minus",NUM_ADD:"NumpadAdd",NUM_SUBTRACT:"NumpadSubtract",NUM_ZERO:"Numpad0",BRACKET_RIGHT:"BracketRight",BRACKET_LEFT:"BracketLeft",ONE:"Digit1",TWO:"Digit2",THREE:"Digit3",NINE:"Digit9",QUOTE:"Quote",ZERO:"Digit0",SLASH:"Slash",C:"KeyC",D:"KeyD",H:"KeyH",V:"KeyV",Z:"KeyZ",Y:"KeyY",R:"KeyR",S:"KeyS"},Ze={ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ARROW_UP:"ArrowUp",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",BACKSPACE:"Backspace",ALT:"Alt",CTRL_OR_CMD:Mt?"metaKey":"ctrlKey",DELETE:"Delete",ENTER:"Enter",ESCAPE:"Escape",QUESTION_MARK:"?",SPACE:" ",TAB:"Tab",CHEVRON_LEFT:"<",CHEVRON_RIGHT:">",PERIOD:".",COMMA:",",SUBTRACT:"-",SLASH:"/",A:"a",C:"c",D:"d",E:"e",F:"f",G:"g",H:"h",I:"i",L:"l",O:"o",P:"p",Q:"q",R:"r",S:"s",T:"t",V:"v",X:"x",Y:"y",Z:"z",K:"k",W:"w",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},xs=new Map([[Ze.Z,mn.Z],[Ze.Y,mn.Y]]);p();p();p();p();function Ce(e){return e*Math.PI/180}p();p();p();function Qe(e,t,n=0,o=0){return[e-n,t-o]}function W(e,t=[0,0]){return Qe(e[0]-t[0],e[1]-t[1])}function w(e,t){return[e,t]}function Dt(e){return e.length===2?w(e[0],e[1]):void 0}function _([e,t],[n,o],i){return w((e-n)*Math.cos(i)-(t-o)*Math.sin(i)+n,(e-n)*Math.sin(i)+(t-o)*Math.cos(i)+o)}function X(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}p();p();p();p();p();p();p();p();var Wo=Lt(Pn(),1);p();p();function yn(){return Math.floor(Math.random()*2**31)}var be=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}};p();var Xo="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u2C00-\uFB1C\uFDFE-\uFE6F\uFEFD-\uFFFF",$o="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC",Na=new RegExp(`^[^${Xo}]*[${$o}]`);var ue=e=>{let t=e.length===5&&e.substr(4,1)==="0",n=e.length===9&&e.substr(7,2)==="00";return t||n||e===S.transparent};var pe=e=>e instanceof Map?e:e.reduce((t,n)=>(t.set(typeof n=="string"?n:n.id,n),t),new Map);var me=()=>g.MODE===vt.TEST,we=()=>g.MODE===vt.DEVELOPMENT;var bn=(e,t)=>Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t,wn=(e,t,n,o=!1)=>{let i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return o&&console.warn("%cisShallowEqual: objects don't have same properties ->","color: #8B4000",e,t),!1;if(n&&Array.isArray(n)){for(let a of n)if(!(e[a]===t[a]||bn(e[a],t[a])))return o&&console.warn(`%cisShallowEqual: ${a} not equal ->`,"color: #8B4000",e[a],t[a]),!1;return!0}return i.every(a=>{let r=n?.[a],l=r?r(e[a],t[a]):e[a]===t[a]||bn(e[a],t[a]);return!l&&o&&console.warn(`%cisShallowEqual: ${a} not equal ->`,"color: #8B4000",e[a],t[a]),l})};var Ft=(e,t,n)=>{if(!t)return e;if(n)return console.error(t),e;throw new Error(t)};function ie(e,t){if(!e)throw new Error(t)}var za=new be(Date.now());p();var ni=Lt(In(),1);p();p();p();p();p();p();p();p();p();function Ot(e,t,n){if(e&&e.length){let[o,i]=t,s=Math.PI/180*n,a=Math.cos(s),r=Math.sin(s);for(let l of e){let[c,d]=l;l[0]=(c-o)*a-(d-i)*r+o,l[1]=(c-o)*r+(d-i)*a+i}}}function oi(e,t,n){let o=[];e.forEach(i=>o.push(...i)),Ot(o,t,n)}function ii(e,t){return e[0]===t[0]&&e[1]===t[1]}function Tn(e,t,n,o=1){let i=n,s=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,r=[0,0];if(i)for(let c of a)Ot(c,r,i);let l=ri(a,s,o);if(i){for(let c of a)Ot(c,r,-i);oi(l,r,-i)}return l}function ri(e,t,n){let o=[];for(let c of e){let d=[...c];ii(d[0],d[d.length-1])||d.push([d[0][0],d[0][1]]),d.length>2&&o.push(d)}let i=[];t=Math.max(t,.1);let s=[];for(let c of o)for(let d=0;d<c.length-1;d++){let m=c[d],f=c[d+1];if(m[1]!==f[1]){let u=Math.min(m[1],f[1]);s.push({ymin:u,ymax:Math.max(m[1],f[1]),x:u===m[1]?m[0]:f[0],islope:(f[0]-m[0])/(f[1]-m[1])})}}if(s.sort((c,d)=>c.ymin<d.ymin?-1:c.ymin>d.ymin?1:c.x<d.x?-1:c.x>d.x?1:c.ymax===d.ymax?0:(c.ymax-d.ymax)/Math.abs(c.ymax-d.ymax)),!s.length)return i;let a=[],r=s[0].ymin,l=0;for(;a.length||s.length;){if(s.length){let c=-1;for(let m=0;m<s.length&&!(s[m].ymin>r);m++)c=m;s.splice(0,c+1).forEach(m=>{a.push({s:r,edge:m})})}if(a=a.filter(c=>!(c.edge.ymax<=r)),a.sort((c,d)=>c.edge.x===d.edge.x?0:(c.edge.x-d.edge.x)/Math.abs(c.edge.x-d.edge.x)),(n!==1||l%t===0)&&a.length>1)for(let c=0;c<a.length;c=c+2){let d=c+1;if(d>=a.length)break;let m=a[c].edge,f=a[d].edge;i.push([[Math.round(m.x),r],[Math.round(f.x),r]])}r+=n,a.forEach(c=>{c.edge.x=c.edge.x+n*c.edge.islope}),l++}return i}function Q(e,t){var n;let o=t.hachureAngle+90,i=t.hachureGap;i<0&&(i=t.strokeWidth*4),i=Math.max(i,.1);let s=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(s=i),Tn(e,i,o,s||1)}var re=class{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){let o=Q(t,n);return{type:"fillSketch",ops:this.renderLines(o,n)}}renderLines(t,n){let o=[];for(let i of t)o.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],n));return o}};p();p();function se(e){let t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}var et=class extends re{fillPolygons(t,n){let o=n.hachureGap;o<0&&(o=n.strokeWidth*4),o=Math.max(o,.1);let i=Object.assign({},n,{hachureGap:o}),s=Q(t,i),a=Math.PI/180*n.hachureAngle,r=[],l=o*.5*Math.cos(a),c=o*.5*Math.sin(a);for(let[m,f]of s)se([m,f])&&r.push([[m[0]-l,m[1]+c],[...f]],[[m[0]+l,m[1]-c],[...f]]);return{type:"fillSketch",ops:this.renderLines(r,n)}}};p();var tt=class extends re{fillPolygons(t,n){let o=this._fillPolygons(t,n),i=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),s=this._fillPolygons(t,i);return o.ops=o.ops.concat(s.ops),o}};p();var nt=class{constructor(t){this.helper=t}fillPolygons(t,n){n=Object.assign({},n,{hachureAngle:0});let o=Q(t,n);return this.dotsOnLines(o,n)}dotsOnLines(t,n){let o=[],i=n.hachureGap;i<0&&(i=n.strokeWidth*4),i=Math.max(i,.1);let s=n.fillWeight;s<0&&(s=n.strokeWidth/2);let a=i/4;for(let r of t){let l=se(r),c=l/i,d=Math.ceil(c)-1,m=l-d*i,f=(r[0][0]+r[1][0])/2-i/4,u=Math.min(r[0][1],r[1][1]);for(let h=0;h<d;h++){let E=u+m+h*i,P=f-a+Math.random()*2*a,y=E-a+Math.random()*2*a,I=this.helper.ellipse(P,y,s,s,n);o.push(...I.ops)}}return{type:"fillSketch",ops:o}}};p();var ot=class{constructor(t){this.helper=t}fillPolygons(t,n){let o=Q(t,n);return{type:"fillSketch",ops:this.dashedLine(o,n)}}dashedLine(t,n){let o=n.dashOffset<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashOffset,i=n.dashGap<0?n.hachureGap<0?n.strokeWidth*4:n.hachureGap:n.dashGap,s=[];return t.forEach(a=>{let r=se(a),l=Math.floor(r/(o+i)),c=(r+i-l*(o+i))/2,d=a[0],m=a[1];d[0]>m[0]&&(d=a[1],m=a[0]);let f=Math.atan((m[1]-d[1])/(m[0]-d[0]));for(let u=0;u<l;u++){let h=u*(o+i),E=h+o,P=[d[0]+h*Math.cos(f)+c*Math.cos(f),d[1]+h*Math.sin(f)+c*Math.sin(f)],y=[d[0]+E*Math.cos(f)+c*Math.cos(f),d[1]+E*Math.sin(f)+c*Math.sin(f)];s.push(...this.helper.doubleLineOps(P[0],P[1],y[0],y[1],n))}}),s}};p();var it=class{constructor(t){this.helper=t}fillPolygons(t,n){let o=n.hachureGap<0?n.strokeWidth*4:n.hachureGap,i=n.zigzagOffset<0?o:n.zigzagOffset;n=Object.assign({},n,{hachureGap:o+i});let s=Q(t,n);return{type:"fillSketch",ops:this.zigzagLines(s,i,n)}}zigzagLines(t,n,o){let i=[];return t.forEach(s=>{let a=se(s),r=Math.round(a/(2*n)),l=s[0],c=s[1];l[0]>c[0]&&(l=s[1],c=s[0]);let d=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let m=0;m<r;m++){let f=m*2*n,u=(m+1)*2*n,h=Math.sqrt(2*Math.pow(n,2)),E=[l[0]+f*Math.cos(d),l[1]+f*Math.sin(d)],P=[l[0]+u*Math.cos(d),l[1]+u*Math.sin(d)],y=[E[0]+h*Math.cos(d+Math.PI/4),E[1]+h*Math.sin(d+Math.PI/4)];i.push(...this.helper.doubleLineOps(E[0],E[1],y[0],y[1],o),...this.helper.doubleLineOps(y[0],y[1],P[0],P[1],o))}}),i}};var U={};function Sn(e,t){let n=e.fillStyle||"hachure";if(!U[n])switch(n){case"zigzag":U[n]||(U[n]=new et(t));break;case"cross-hatch":U[n]||(U[n]=new tt(t));break;case"dots":U[n]||(U[n]=new nt(t));break;case"dashed":U[n]||(U[n]=new ot(t));break;case"zigzag-line":U[n]||(U[n]=new it(t));break;case"hachure":default:n="hachure",U[n]||(U[n]=new re(t));break}return U[n]}p();p();var rt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function si(e){let t=new Array;for(;e!=="";)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]={type:0,text:RegExp.$1},e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]={type:1,text:`${parseFloat(RegExp.$1)}`},e=e.substr(RegExp.$1.length);else return[];return t[t.length]={type:2,text:""},t}function Nt(e,t){return e.type===t}function Ie(e){let t=[],n=si(e),o="BOD",i=0,s=n[i];for(;!Nt(s,2);){let a=0,r=[];if(o==="BOD")if(s.text==="M"||s.text==="m")i++,a=rt[s.text],o=s.text;else return Ie("M0,0"+e);else Nt(s,1)?a=rt[o]:(i++,a=rt[s.text],o=s.text);if(i+a<n.length){for(let l=i;l<i+a;l++){let c=n[l];if(Nt(c,1))r[r.length]=+c.text;else throw new Error("Param not a number: "+o+","+c.text)}if(typeof rt[o]=="number"){let l={key:o,data:r};t.push(l),i+=a,s=n[i],o==="M"&&(o="L"),o==="m"&&(o="l")}else throw new Error("Bad segment: "+o)}else throw new Error("Path data ended short")}return t}p();function Re(e){let t=0,n=0,o=0,i=0,s=[];for(let{key:a,data:r}of e)switch(a){case"M":s.push({key:"M",data:[...r]}),[t,n]=r,[o,i]=r;break;case"m":t+=r[0],n+=r[1],s.push({key:"M",data:[t,n]}),o=t,i=n;break;case"L":s.push({key:"L",data:[...r]}),[t,n]=r;break;case"l":t+=r[0],n+=r[1],s.push({key:"L",data:[t,n]});break;case"C":s.push({key:"C",data:[...r]}),t=r[4],n=r[5];break;case"c":{let l=r.map((c,d)=>d%2?c+n:c+t);s.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":s.push({key:"Q",data:[...r]}),t=r[2],n=r[3];break;case"q":{let l=r.map((c,d)=>d%2?c+n:c+t);s.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":s.push({key:"A",data:[...r]}),t=r[5],n=r[6];break;case"a":t+=r[5],n+=r[6],s.push({key:"A",data:[r[0],r[1],r[2],r[3],r[4],t,n]});break;case"H":s.push({key:"H",data:[...r]}),t=r[0];break;case"h":t+=r[0],s.push({key:"H",data:[t]});break;case"V":s.push({key:"V",data:[...r]}),n=r[0];break;case"v":n+=r[0],s.push({key:"V",data:[n]});break;case"S":s.push({key:"S",data:[...r]}),t=r[2],n=r[3];break;case"s":{let l=r.map((c,d)=>d%2?c+n:c+t);s.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":s.push({key:"T",data:[...r]}),t=r[0],n=r[1];break;case"t":t+=r[0],n+=r[1],s.push({key:"T",data:[t,n]});break;case"Z":case"z":s.push({key:"Z",data:[]}),t=o,n=i;break}return s}p();function Ge(e){let t=[],n="",o=0,i=0,s=0,a=0,r=0,l=0;for(let{key:c,data:d}of e){switch(c){case"M":t.push({key:"M",data:[...d]}),[o,i]=d,[s,a]=d;break;case"C":t.push({key:"C",data:[...d]}),o=d[4],i=d[5],r=d[2],l=d[3];break;case"L":t.push({key:"L",data:[...d]}),[o,i]=d;break;case"H":o=d[0],t.push({key:"L",data:[o,i]});break;case"V":i=d[0],t.push({key:"L",data:[o,i]});break;case"S":{let m=0,f=0;n==="C"||n==="S"?(m=o+(o-r),f=i+(i-l)):(m=o,f=i),t.push({key:"C",data:[m,f,...d]}),r=d[0],l=d[1],o=d[2],i=d[3];break}case"T":{let[m,f]=d,u=0,h=0;n==="Q"||n==="T"?(u=o+(o-r),h=i+(i-l)):(u=o,h=i);let E=o+2*(u-o)/3,P=i+2*(h-i)/3,y=m+2*(u-m)/3,I=f+2*(h-f)/3;t.push({key:"C",data:[E,P,y,I,m,f]}),r=u,l=h,o=m,i=f;break}case"Q":{let[m,f,u,h]=d,E=o+2*(m-o)/3,P=i+2*(f-i)/3,y=u+2*(m-u)/3,I=h+2*(f-h)/3;t.push({key:"C",data:[E,P,y,I,u,h]}),r=m,l=f,o=u,i=h;break}case"A":{let m=Math.abs(d[0]),f=Math.abs(d[1]),u=d[2],h=d[3],E=d[4],P=d[5],y=d[6];m===0||f===0?(t.push({key:"C",data:[o,i,P,y,P,y]}),o=P,i=y):(o!==P||i!==y)&&(Ln(o,i,P,y,m,f,u,h,E).forEach(function(H){t.push({key:"C",data:H})}),o=P,i=y);break}case"Z":t.push({key:"Z",data:[]}),o=s,i=a;break}n=c}return t}function ai(e){return Math.PI*e/180}function Be(e,t,n){let o=e*Math.cos(n)-t*Math.sin(n),i=e*Math.sin(n)+t*Math.cos(n);return[o,i]}function Ln(e,t,n,o,i,s,a,r,l,c){let d=ai(a),m=[],f=0,u=0,h=0,E=0;if(c)[f,u,h,E]=c;else{[e,t]=Be(e,t,-d),[n,o]=Be(n,o,-d);let N=(e-n)/2,T=(t-o)/2,B=N*N/(i*i)+T*T/(s*s);B>1&&(B=Math.sqrt(B),i=B*i,s=B*s);let L=r===l?-1:1,D=i*i,b=s*s,v=D*b-D*T*T-b*N*N,A=D*T*T+b*N*N,R=L*Math.sqrt(Math.abs(v/A));h=R*i*T/s+(e+n)/2,E=R*-s*N/i+(t+o)/2,f=Math.asin(parseFloat(((t-E)/s).toFixed(9))),u=Math.asin(parseFloat(((o-E)/s).toFixed(9))),e<h&&(f=Math.PI-f),n<h&&(u=Math.PI-u),f<0&&(f=Math.PI*2+f),u<0&&(u=Math.PI*2+u),l&&f>u&&(f=f-Math.PI*2),!l&&u>f&&(u=u-Math.PI*2)}let P=u-f;if(Math.abs(P)>Math.PI*120/180){let N=u,T=n,B=o;l&&u>f?u=f+Math.PI*120/180*1:u=f+Math.PI*120/180*-1,n=h+i*Math.cos(u),o=E+s*Math.sin(u),m=Ln(n,o,T,B,i,s,a,0,l,[u,N,h,E])}P=u-f;let y=Math.cos(f),I=Math.sin(f),H=Math.cos(u),J=Math.sin(u),C=Math.tan(P/4),M=4/3*i*C,O=4/3*s*C,G=[e,t],F=[e+M*I,t-O*y],k=[n+M*J,o-O*H],z=[n,o];if(F[0]=2*G[0]-F[0],F[1]=2*G[1]-F[1],c)return[F,k,z].concat(m);{m=[F,k,z].concat(m);let N=[];for(let T=0;T<m.length;T+=3){let B=Be(m[T][0],m[T][1],d),L=Be(m[T+1][0],m[T+1][1],d),D=Be(m[T+2][0],m[T+2][1],d);N.push([B[0],B[1],L[0],L[1],D[0],D[1]])}return N}}var li={randOffset:ui,randOffsetWithRange:pi,ellipse:di,doubleLineOps:mi};function _t(e,t,n,o,i){return{type:"path",ops:ee(e,t,n,o,i)}}function Fe(e,t,n){let o=(e||[]).length;if(o>2){let i=[];for(let s=0;s<o-1;s++)i.push(...ee(e[s][0],e[s][1],e[s+1][0],e[s+1][1],n));return t&&i.push(...ee(e[o-1][0],e[o-1][1],e[0][0],e[0][1],n)),{type:"path",ops:i}}else if(o===2)return _t(e[0][0],e[0][1],e[1][0],e[1][1],n);return{type:"path",ops:[]}}function ci(e,t){return Fe(e,!0,t)}function Dn(e,t,n,o,i){let s=[[e,t],[e+n,t],[e+n,t+o],[e,t+o]];return ci(s,i)}function kt(e,t){let n=vn(e,1*(1+t.roughness*.2),t);if(!t.disableMultiStroke){let o=vn(e,1.5*(1+t.roughness*.22),fi(t));n=n.concat(o)}return{type:"path",ops:n}}function di(e,t,n,o,i){let s=Ht(n,o,i);return lt(e,t,i,s).opset}function Ht(e,t,n){let o=Math.sqrt(Math.PI*2*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*o)),s=Math.PI*2/i,a=Math.abs(e/2),r=Math.abs(t/2),l=1-n.curveFitting;return a+=x(a*l,n),r+=x(r*l,n),{increment:s,rx:a,ry:r}}function lt(e,t,n,o){let[i,s]=An(o.increment,e,t,o.rx,o.ry,1,o.increment*st(.1,st(.4,1,n),n),n),a=at(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){let[r]=An(o.increment,e,t,o.rx,o.ry,1.5,0,n),l=at(r,null,n);a=a.concat(l)}return{estimatedPoints:s,opset:{type:"path",ops:a}}}function Ut(e,t,n,o,i,s,a,r,l){let c=e,d=t,m=Math.abs(n/2),f=Math.abs(o/2);m+=x(m*.01,l),f+=x(f*.01,l);let u=i,h=s;for(;u<0;)u+=Math.PI*2,h+=Math.PI*2;h-u>Math.PI*2&&(u=0,h=Math.PI*2);let E=Math.PI*2/l.curveStepCount,P=Math.min(E/2,(h-u)/2),y=Cn(P,c,d,m,f,u,h,1,l);if(!l.disableMultiStroke){let I=Cn(P,c,d,m,f,u,h,1.5,l);y.push(...I)}return a&&(r?y.push(...ee(c,d,c+m*Math.cos(u),d+f*Math.sin(u),l),...ee(c,d,c+m*Math.cos(h),d+f*Math.sin(h),l)):y.push({op:"lineTo",data:[c,d]},{op:"lineTo",data:[c+m*Math.cos(u),d+f*Math.sin(u)]})),{type:"path",ops:y}}function zt(e,t){let n=Ge(Re(Ie(e))),o=[],i=[0,0],s=[0,0];for(let{key:a,data:r}of n)switch(a){case"M":{s=[r[0],r[1]],i=[r[0],r[1]];break}case"L":o.push(...ee(s[0],s[1],r[0],r[1],t)),s=[r[0],r[1]];break;case"C":{let[l,c,d,m,f,u]=r;o.push(...hi(l,c,d,m,f,u,s,t)),s=[f,u];break}case"Z":o.push(...ee(s[0],s[1],i[0],i[1],t)),s=[i[0],i[1]];break}return{type:"path",ops:o}}function ct(e,t){let n=[];for(let o of e)if(o.length){let i=t.maxRandomnessOffset||0,s=o.length;if(s>2){n.push({op:"move",data:[o[0][0]+x(i,t),o[0][1]+x(i,t)]});for(let a=1;a<s;a++)n.push({op:"lineTo",data:[o[a][0]+x(i,t),o[a][1]+x(i,t)]})}}return{type:"fillPath",ops:n}}function fe(e,t){return Sn(t,li).fillPolygons(e,t)}function Rn(e,t,n,o,i,s,a){let r=e,l=t,c=Math.abs(n/2),d=Math.abs(o/2);c+=x(c*.01,a),d+=x(d*.01,a);let m=i,f=s;for(;m<0;)m+=Math.PI*2,f+=Math.PI*2;f-m>Math.PI*2&&(m=0,f=Math.PI*2);let u=(f-m)/a.curveStepCount,h=[];for(let E=m;E<=f;E=E+u)h.push([r+c*Math.cos(E),l+d*Math.sin(E)]);return h.push([r+c*Math.cos(f),l+d*Math.sin(f)]),h.push([r,l]),fe([h],a)}function ui(e,t){return x(e,t)}function pi(e,t,n){return st(e,t,n)}function mi(e,t,n,o,i){return ee(e,t,n,o,i,!0)}function fi(e){let t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Bn(e){return e.randomizer||(e.randomizer=new be(e.seed||0)),e.randomizer.next()}function st(e,t,n,o=1){return n.roughness*o*(Bn(n)*(t-e)+e)}function x(e,t,n=1){return st(-e,e,t,n)}function ee(e,t,n,o,i,s=!1){let a=s?i.disableMultiStrokeFill:i.disableMultiStroke,r=Mn(e,t,n,o,i,!0,!1);if(a)return r;let l=Mn(e,t,n,o,i,!0,!0);return r.concat(l)}function Mn(e,t,n,o,i,s,a){let r=Math.pow(e-n,2)+Math.pow(t-o,2),l=Math.sqrt(r),c=1;l<200?c=1:l>500?c=.4:c=-.0016668*l+1.233334;let d=i.maxRandomnessOffset||0;d*d*100>r&&(d=l/10);let m=d/2,f=.2+Bn(i)*.2,u=i.bowing*i.maxRandomnessOffset*(o-t)/200,h=i.bowing*i.maxRandomnessOffset*(e-n)/200;u=x(u,i,c),h=x(h,i,c);let E=[],P=()=>x(m,i,c),y=()=>x(d,i,c),I=i.preserveVertices;return s&&(a?E.push({op:"move",data:[e+(I?0:P()),t+(I?0:P())]}):E.push({op:"move",data:[e+(I?0:x(d,i,c)),t+(I?0:x(d,i,c))]})),a?E.push({op:"bcurveTo",data:[u+e+(n-e)*f+P(),h+t+(o-t)*f+P(),u+e+2*(n-e)*f+P(),h+t+2*(o-t)*f+P(),n+(I?0:P()),o+(I?0:P())]}):E.push({op:"bcurveTo",data:[u+e+(n-e)*f+y(),h+t+(o-t)*f+y(),u+e+2*(n-e)*f+y(),h+t+2*(o-t)*f+y(),n+(I?0:y()),o+(I?0:y())]}),E}function vn(e,t,n){let o=[];o.push([e[0][0]+x(t,n),e[0][1]+x(t,n)]),o.push([e[0][0]+x(t,n),e[0][1]+x(t,n)]);for(let i=1;i<e.length;i++)o.push([e[i][0]+x(t,n),e[i][1]+x(t,n)]),i===e.length-1&&o.push([e[i][0]+x(t,n),e[i][1]+x(t,n)]);return at(o,null,n)}function at(e,t,n){let o=e.length,i=[];if(o>3){let s=[],a=1-n.curveTightness;i.push({op:"move",data:[e[1][0],e[1][1]]});for(let r=1;r+2<o;r++){let l=e[r];s[0]=[l[0],l[1]],s[1]=[l[0]+(a*e[r+1][0]-a*e[r-1][0])/6,l[1]+(a*e[r+1][1]-a*e[r-1][1])/6],s[2]=[e[r+1][0]+(a*e[r][0]-a*e[r+2][0])/6,e[r+1][1]+(a*e[r][1]-a*e[r+2][1])/6],s[3]=[e[r+1][0],e[r+1][1]],i.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}if(t&&t.length===2){let r=n.maxRandomnessOffset;i.push({op:"lineTo",data:[t[0]+x(r,n),t[1]+x(r,n)]})}}else o===3?(i.push({op:"move",data:[e[1][0],e[1][1]]}),i.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):o===2&&i.push(...ee(e[0][0],e[0][1],e[1][0],e[1][1],n));return i}function An(e,t,n,o,i,s,a,r){let l=r.roughness===0,c=[],d=[];if(l){e=e/4,d.push([t+o*Math.cos(-e),n+i*Math.sin(-e)]);for(let m=0;m<=Math.PI*2;m=m+e){let f=[t+o*Math.cos(m),n+i*Math.sin(m)];c.push(f),d.push(f)}d.push([t+o*Math.cos(0),n+i*Math.sin(0)]),d.push([t+o*Math.cos(e),n+i*Math.sin(e)])}else{let m=x(.5,r)-Math.PI/2;d.push([x(s,r)+t+.9*o*Math.cos(m-e),x(s,r)+n+.9*i*Math.sin(m-e)]);let f=Math.PI*2+m-.01;for(let u=m;u<f;u=u+e){let h=[x(s,r)+t+o*Math.cos(u),x(s,r)+n+i*Math.sin(u)];c.push(h),d.push(h)}d.push([x(s,r)+t+o*Math.cos(m+Math.PI*2+a*.5),x(s,r)+n+i*Math.sin(m+Math.PI*2+a*.5)]),d.push([x(s,r)+t+.98*o*Math.cos(m+a),x(s,r)+n+.98*i*Math.sin(m+a)]),d.push([x(s,r)+t+.9*o*Math.cos(m+a*.5),x(s,r)+n+.9*i*Math.sin(m+a*.5)])}return[d,c]}function Cn(e,t,n,o,i,s,a,r,l){let c=s+x(.1,l),d=[];d.push([x(r,l)+t+.9*o*Math.cos(c-e),x(r,l)+n+.9*i*Math.sin(c-e)]);for(let m=c;m<=a;m=m+e)d.push([x(r,l)+t+o*Math.cos(m),x(r,l)+n+i*Math.sin(m)]);return d.push([t+o*Math.cos(a),n+i*Math.sin(a)]),d.push([t+o*Math.cos(a),n+i*Math.sin(a)]),at(d,null,l)}function hi(e,t,n,o,i,s,a,r){let l=[],c=[r.maxRandomnessOffset||1,(r.maxRandomnessOffset||1)+.3],d=[0,0],m=r.disableMultiStroke?1:2,f=r.preserveVertices;for(let u=0;u<m;u++)u===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(f?0:x(c[0],r)),a[1]+(f?0:x(c[0],r))]}),d=f?[i,s]:[i+x(c[u],r),s+x(c[u],r)],l.push({op:"bcurveTo",data:[e+x(c[u],r),t+x(c[u],r),n+x(c[u],r),o+x(c[u],r),d[0],d[1]]});return l}p();function Oe(e){return[...e]}function Gn(e,t=0){let n=e.length;if(n<3)throw new Error("A curve must have at least three points.");let o=[];if(n===3)o.push(Oe(e[0]),Oe(e[1]),Oe(e[2]),Oe(e[2]));else{let i=[];i.push(e[0],e[0]);for(let r=1;r<e.length;r++)i.push(e[r]),r===e.length-1&&i.push(e[r]);let s=[],a=1-t;o.push(Oe(i[0]));for(let r=1;r+2<i.length;r++){let l=i[r];s[0]=[l[0],l[1]],s[1]=[l[0]+(a*i[r+1][0]-a*i[r-1][0])/6,l[1]+(a*i[r+1][1]-a*i[r-1][1])/6],s[2]=[i[r+1][0]+(a*i[r][0]-a*i[r+2][0])/6,i[r+1][1]+(a*i[r][1]-a*i[r+2][1])/6],s[3]=[i[r+1][0],i[r+1][1]],o.push(s[1],s[2],s[3])}}return o}p();function gi(e,t){return Math.sqrt(dt(e,t))}function dt(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Ei(e,t,n){let o=dt(t,n);if(o===0)return dt(e,t);let i=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/o;return i=Math.max(0,Math.min(1,i)),dt(e,he(t,n,i))}function he(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function xi(e,t){let n=e[t+0],o=e[t+1],i=e[t+2],s=e[t+3],a=3*o[0]-2*n[0]-s[0];a*=a;let r=3*o[1]-2*n[1]-s[1];r*=r;let l=3*i[0]-2*s[0]-n[0];l*=l;let c=3*i[1]-2*s[1]-n[1];return c*=c,a<l&&(a=l),r<c&&(r=c),a+r}function Yt(e,t,n,o){let i=o||[];if(xi(e,t)<n){let s=e[t+0];i.length?gi(i[i.length-1],s)>1&&i.push(s):i.push(s),i.push(e[t+3])}else{let a=e[t+0],r=e[t+1],l=e[t+2],c=e[t+3],d=he(a,r,.5),m=he(r,l,.5),f=he(l,c,.5),u=he(d,m,.5),h=he(m,f,.5),E=he(u,h,.5);Yt([a,d,u,E],0,n,i),Yt([E,h,f,c],0,n,i)}return i}function pt(e,t){return ut(e,0,e.length,t)}function ut(e,t,n,o,i){let s=i||[],a=e[t],r=e[n-1],l=0,c=1;for(let d=t+1;d<n-1;++d){let m=Ei(e[d],a,r);m>l&&(l=m,c=d)}return Math.sqrt(l)>o?(ut(e,t,c+1,o,s),ut(e,c,n,o,s)):(s.length||s.push(a),s.push(r)),s}function Ne(e,t=.15,n){let o=[],i=(e.length-1)/3;for(let s=0;s<i;s++){let a=s*3;Yt(e,a,t,o)}return n&&n>0?ut(o,0,o.length,n):o}p();function Fn(e,t,n){let o=Ie(e),i=Ge(Re(o)),s=[],a=[],r=[0,0],l=[],c=()=>{l.length>=4&&a.push(...Ne(l,t)),l=[]},d=()=>{c(),a.length&&(s.push(a),a=[])};for(let{key:f,data:u}of i)switch(f){case"M":d(),r=[u[0],u[1]],a.push(r);break;case"L":c(),a.push([u[0],u[1]]);break;case"C":if(!l.length){let h=a.length?a[a.length-1]:r;l.push([h[0],h[1]])}l.push([u[0],u[1]]),l.push([u[2],u[3]]),l.push([u[4],u[5]]);break;case"Z":c(),a.push([r[0],r[1]]);break}if(d(),!n)return s;let m=[];for(let f of s){let u=pt(f,n);u.length&&m.push(u)}return m}var Y="none",ge=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return yn()}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,o){return{shape:t,sets:n||[],options:o||this.defaultOptions}}line(t,n,o,i,s){let a=this._o(s);return this._d("line",[_t(t,n,o,i,a)],a)}rectangle(t,n,o,i,s){let a=this._o(s),r=[],l=Dn(t,n,o,i,a);if(a.fill){let c=[[t,n],[t+o,n],[t+o,n+i],[t,n+i]];a.fillStyle==="solid"?r.push(ct([c],a)):r.push(fe([c],a))}return a.stroke!==Y&&r.push(l),this._d("rectangle",r,a)}ellipse(t,n,o,i,s){let a=this._o(s),r=[],l=Ht(o,i,a),c=lt(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){let d=lt(t,n,a,l).opset;d.type="fillPath",r.push(d)}else r.push(fe([c.estimatedPoints],a));return a.stroke!==Y&&r.push(c.opset),this._d("ellipse",r,a)}circle(t,n,o,i){let s=this.ellipse(t,n,o,o,i);return s.shape="circle",s}linearPath(t,n){let o=this._o(n);return this._d("linearPath",[Fe(t,!1,o)],o)}arc(t,n,o,i,s,a,r=!1,l){let c=this._o(l),d=[],m=Ut(t,n,o,i,s,a,r,!0,c);if(r&&c.fill)if(c.fillStyle==="solid"){let f=Object.assign({},c);f.disableMultiStroke=!0;let u=Ut(t,n,o,i,s,a,!0,!1,f);u.type="fillPath",d.push(u)}else d.push(Rn(t,n,o,i,s,a,c));return c.stroke!==Y&&d.push(m),this._d("arc",d,c)}curve(t,n){let o=this._o(n),i=[],s=kt(t,o);if(o.fill&&o.fill!==Y&&t.length>=3)if(o.fillStyle==="solid"){let a=kt(t,Object.assign(Object.assign({},o),{disableMultiStroke:!0,roughness:o.roughness?o.roughness+o.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{let a=Gn(t),r=Ne(a,10,(1+o.roughness)/2);i.push(fe([r],o))}return o.stroke!==Y&&i.push(s),this._d("curve",i,o)}polygon(t,n){let o=this._o(n),i=[],s=Fe(t,!0,o);return o.fill&&(o.fillStyle==="solid"?i.push(ct([t],o)):i.push(fe([t],o))),o.stroke!==Y&&i.push(s),this._d("polygon",i,o)}path(t,n){let o=this._o(n),i=[];if(!t)return this._d("path",i,o);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let s=o.fill&&o.fill!=="transparent"&&o.fill!==Y,a=o.stroke!==Y,r=!!(o.simplification&&o.simplification<1),l=r?4-4*(o.simplification||1):(1+o.roughness)/2,c=Fn(t,1,l),d=zt(t,o);if(s)if(o.fillStyle==="solid")if(c.length===1){let m=zt(t,Object.assign(Object.assign({},o),{disableMultiStroke:!0,roughness:o.roughness?o.roughness+o.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(m.ops)})}else i.push(ct(c,o));else i.push(fe(c,o));return a&&(r?c.forEach(m=>{i.push(Fe(m,!1,o))}):i.push(d)),this._d("path",i,o)}opsToPath(t,n){let o="";for(let i of t.ops){let s=typeof n=="number"&&n>=0?i.data.map(a=>+a.toFixed(n)):i.data;switch(i.op){case"move":o+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":o+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":o+=`L${s[0]} ${s[1]} `;break}}return o.trim()}toPaths(t){let n=t.sets||[],o=t.options||this.defaultOptions,i=[];for(let s of n){let a=null;switch(s.type){case"path":a={d:this.opsToPath(s),stroke:o.stroke,strokeWidth:o.strokeWidth,fill:Y};break;case"fillPath":a={d:this.opsToPath(s),stroke:Y,strokeWidth:0,fill:o.fill||Y};break;case"fillSketch":a=this.fillSketch(s,o);break}a&&i.push(a)}return i}fillSketch(t,n){let o=n.fillWeight;return o<0&&(o=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Y,strokeWidth:o,fill:Y}}_mergedShape(t){return t.filter((n,o)=>o===0?!0:n.op!=="move")}};p();p();p();var mt=e=>{if(!e)return[];for(let t of e.sets)if(t.type==="path")return t.ops;return e.sets[0].ops};p();p();p();var On=e=>!!e&&e.type==="embeddable",Nn=e=>!!e&&e.type==="iframe",Wt=e=>!!e&&(e.type==="iframe"||e.type==="embeddable"),ae=e=>e!=null&&e.type==="text";var _e=e=>e!=null&&(e.type==="frame"||e.type==="magicframe"),ke=e=>e!=null&&bi(e.type),bi=e=>e==="freedraw",le=e=>e!=null&&Xt(e.type),Ee=e=>e!=null&&e.type==="arrow",He=e=>Ee(e)&&e.elbowed,Xt=e=>e==="arrow"||e==="line";var wi=(e,t=!0)=>e!=null&&(!e.locked||t===!0)&&(e.type==="rectangle"||e.type==="diamond"||e.type==="ellipse"||Ee(e));var ft=e=>wi(e)&&!!e.boundElements?.some(({type:t})=>t==="text"),Ue=e=>e!==null&&"containerId"in e&&e.containerId!==null&&ae(e);p();p();p();p();p();p();p();var to=Lt(Yn(),1);p();p();p();p();p();p();p();p();var jt=[1,0],Wn=[0,1],qt=[-1,0],Xn=[0,-1];var Et=e=>{let[t,n]=e,o=Math.abs(t),i=Math.abs(n);return t>i?jt:t<=-i?qt:n>o?Wn:Xn},$n=(e,t)=>Et(W(e,t)),xt=(e,t)=>Pt($n(e,t)),Kt=(e,t)=>e[0]===t[0]&&e[1]===t[1],Pt=e=>Kt(e,jt)||Kt(e,qt);p();var ju="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".toLocaleUpperCase();p();var sr=e=>e?.boundElements?.length&&e?.boundElements?.find(t=>t.type==="text")?.id||null,te=(e,t)=>{if(!e)return null;let n=sr(e);return n&&t.get(n)||null};p();p();p();p();var Jn=(e,t)=>{let n=[];for(let o of e.values())o.frameId===t&&n.push(o);return n};var om=function(){let e=null,t=null,n=null,o=(i,s)=>(n!=null&&i===e&&s.selectedElementIds===t||(n=i.some(a=>s.selectedElementIds[a.id]),e=i,t=s.selectedElementIds),n);return o.clearCache=()=>{e=null,t=null,n=null},o}();var bt=(e,t,n)=>{let o=new Set,i=[];for(let s of e.values()){if(t.selectedElementIds[s.id]){i.push(s),o.add(s.id);continue}if(n?.includeBoundTextElement&&Ue(s)&&t.selectedElementIds[s?.containerId]){i.push(s),o.add(s.id);continue}}if(n?.includeElementsInFrames){let s=[];return i.forEach(a=>{_e(a)&&Jn(e,a.id).forEach(r=>!o.has(r.id)&&s.push(r)),s.push(a)}),s}return i};var Zt=(e,t)=>wn(t.selectedElementIds,e)?t.selectedElementIds:e;var cm=function(){let e=null,t=null,n=null,o=(s,a,r,l)=>{if(n!==void 0&&a===t&&s===e&&r.editingGroupId===n?.editingGroupId)return n;let c={};for(let f of s){let u=f.groupIds;if(r.editingGroupId){let h=u.indexOf(r.editingGroupId);h>-1&&(u=u.slice(0,h))}if(u.length>0){let h=u[u.length-1];c[h]=!0}}let d={},m=a.reduce((f,u)=>{if(u.isDeleted)return f;let h=u.groupIds.find(E=>c[E]);return h&&(f[u.id]=!0,Array.isArray(d[h])?d[h].push(u.id):d[h]=[u.id]),f},{});for(let f of Object.keys(d))d[f].length<2&&c[f]&&(c[f]=!1);return t=a,e=s,n={editingGroupId:r.editingGroupId,selectedGroupIds:c,selectedElementIds:Zt({...r.selectedElementIds,...m},l)},n},i=(s,a,r,l)=>{let c=l?l.scene.getSelectedElements({selectedElementIds:s.selectedElementIds,elements:a}):bt(a,s);return c.length?o(c,a,s,r):{selectedGroupIds:{},editingGroupId:null,selectedElementIds:Zt(s.selectedElementIds,r)}};return i.clearCache=()=>{t=null,e=null,n=null},i}();p();p();var Qt=class extends Error{code="ELEMENT_HAS_INVALID_INDEX"},eo=(e,{shouldThrow:t=!1,includeBoundTextValidation:n=!1,ignoreLogs:o,reconciliationContext:i})=>{let s=[],a=l=>`${l?.index}:${l?.id}:${l?.type}:${l?.isDeleted}:${l?.version}:${l?.versionNonce}`,r=e.map(l=>l.index);for(let[l,c]of r.entries()){let d=r[l-1],m=r[l+1];if(dr(c,d,m)||s.push(`Fractional indices invariant has been compromised: "${a(e[l-1])}", "${a(e[l])}", "${a(e[l+1])}"`),n&&ft(e[l])){let f=e[l],u=te(f,pe(e));u&&u.index<=f.index&&s.push(`Fractional indices invariant for bound elements has been compromised: "${a(u)}", "${a(f)}"`)}}if(s.length){let l=new Qt,c=[];if(i&&(c.push("Additional reconciliation context:"),c.push(i.localElements.map(d=>a(d))),c.push(i.remoteElements.map(d=>a(d)))),o||console.error(s.join(`

`),l.stack,e.map(d=>a(d)),...c),t)throw l}};var dr=(e,t,n)=>e?t&&n?t<e&&e<n:!t&&n?e<n:t&&!n?t<e:!!e:!1;var Cm=(0,to.default)(e=>{(we()||me()||window?.DEBUG_FRACTIONAL_INDICES)&&eo(e,{shouldThrow:we()||me(),includeBoundTextValidation:!0})},1e3*60,{leading:!0,trailing:!1});var Se=(e,t)=>{if(t.roundness?.type===Ae.PROPORTIONAL_RADIUS||t.roundness?.type===Ae.LEGACY)return e*qe;if(t.roundness?.type===Ae.ADAPTIVE_RADIUS){let n=t.roundness?.value??pn,o=n/qe;return e<=o?e*qe:n}return 0},ze=(e,t=1)=>{if(e.length>=3){let[n,o]=[e[0],e[e.length-1]];return X(n,o)<=cn/t}return!1};p();var no=e=>e==="rectangle"||e==="iframe"||e==="embeddable"||e==="line"||e==="diamond"||e==="image";p();p();function oo(e,t,n,o=i=>i){return e*o(.5-t*(.5-n))}function pr(e){return[-e[0],-e[1]]}function Z(e,t){return[e[0]+t[0],e[1]+t[1]]}function $(e,t){return[e[0]-t[0],e[1]-t[1]]}function q(e,t){return[e[0]*t,e[1]*t]}function mr(e,t){return[e[0]/t,e[1]/t]}function We(e){return[e[1],-e[0]]}function io(e,t){return e[0]*t[0]+e[1]*t[1]}function fr(e,t){return e[0]===t[0]&&e[1]===t[1]}function hr(e){return Math.hypot(e[0],e[1])}function gr(e){return e[0]*e[0]+e[1]*e[1]}function ro(e,t){return gr($(e,t))}function lo(e){return mr(e,hr(e))}function Er(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function Xe(e,t,n){let o=Math.sin(n),i=Math.cos(n),s=e[0]-t[0],a=e[1]-t[1],r=s*i-a*o,l=s*o+a*i;return[r+t[0],l+t[1]]}function Jt(e,t,n){return Z(e,q($(t,e),n))}function so(e,t,n){return Z(e,q(t,n))}var{min:Le,PI:xr}=Math,ao=.275,$e=xr+1e-4;function Pr(e,t={}){let{size:n=16,smoothing:o=.5,thinning:i=.5,simulatePressure:s=!0,easing:a=b=>b,start:r={},end:l={},last:c=!1}=t,{cap:d=!0,easing:m=b=>b*(2-b)}=r,{cap:f=!0,easing:u=b=>--b*b*b+1}=l;if(e.length===0||n<=0)return[];let h=e[e.length-1].runningLength,E=r.taper===!1?0:r.taper===!0?Math.max(n,h):r.taper,P=l.taper===!1?0:l.taper===!0?Math.max(n,h):l.taper,y=Math.pow(n*o,2),I=[],H=[],J=e.slice(0,10).reduce((b,v)=>{let A=v.pressure;if(s){let R=Le(1,v.distance/n),wt=Le(1,1-R);A=Le(1,b+(wt-b)*(R*ao))}return(b+A)/2},e[0].pressure),C=oo(n,i,e[e.length-1].pressure,a),M,O=e[0].vector,G=e[0].point,F=G,k=G,z=F,N=!1;for(let b=0;b<e.length;b++){let{pressure:v}=e[b],{point:A,vector:R,distance:wt,runningLength:Me}=e[b];if(b<e.length-1&&h-Me<3)continue;if(i){if(s){let oe=Le(1,wt/n),Tt=Le(1,1-oe);v=Le(1,J+(Tt-J)*(oe*ao))}C=oo(n,i,v,a)}else C=n/2;M===void 0&&(M=C);let Po=Me<E?m(Me/E):1,yo=h-Me<P?u((h-Me)/P):1;C=Math.max(.01,C*Math.min(Po,yo));let nn=(b<e.length-1?e[b+1]:e[b]).vector,It=b<e.length-1?io(R,nn):1,bo=io(R,O)<0&&!N,on=It!==null&&It<0;if(bo||on){let oe=q(We(O),C);for(let Tt=1/13,Ve=0;Ve<=1;Ve+=Tt)k=Xe($(A,oe),A,$e*Ve),I.push(k),z=Xe(Z(A,oe),A,$e*-Ve),H.push(z);G=k,F=z,on&&(N=!0);continue}if(N=!1,b===e.length-1){let oe=q(We(R),C);I.push($(A,oe)),H.push(Z(A,oe));continue}let rn=q(We(Jt(nn,R,It)),C);k=$(A,rn),(b<=1||ro(G,k)>y)&&(I.push(k),G=k),z=Z(A,rn),(b<=1||ro(F,z)>y)&&(H.push(z),F=z),J=v,O=R}let T=e[0].point.slice(0,2),B=e.length>1?e[e.length-1].point.slice(0,2):Z(e[0].point,[1,1]),L=[],D=[];if(e.length===1){if(!(E||P)||c){let b=so(T,lo(We($(T,B))),-(M||C)),v=[];for(let A=1/13,R=A;R<=1;R+=A)v.push(Xe(b,T,$e*2*R));return v}}else{if(!(E||P&&e.length===1))if(d)for(let v=1/13,A=v;A<=1;A+=v){let R=Xe(H[0],T,$e*A);L.push(R)}else{let v=$(I[0],H[0]),A=q(v,.5),R=q(v,.51);L.push($(T,A),$(T,R),Z(T,R),Z(T,A))}let b=We(pr(e[e.length-1].vector));if(P||E&&e.length===1)D.push(B);else if(f){let v=so(B,b,C);for(let A=1/29,R=A;R<1;R+=A)D.push(Xe(v,B,$e*3*R))}else D.push(Z(B,q(b,C)),Z(B,q(b,C*.99)),$(B,q(b,C*.99)),$(B,q(b,C)))}return I.concat(D,H.reverse(),L)}function yr(e,t={}){var n;let{streamline:o=.5,size:i=16,last:s=!1}=t;if(e.length===0)return[];let a=.15+(1-o)*.85,r=Array.isArray(e[0])?e:e.map(({x:u,y:h,pressure:E=.5})=>[u,h,E]);if(r.length===2){let u=r[1];r=r.slice(0,-1);for(let h=1;h<5;h++)r.push(Jt(r[0],u,h/4))}r.length===1&&(r=[...r,[...Z(r[0],[1,1]),...r[0].slice(2)]]);let l=[{point:[r[0][0],r[0][1]],pressure:r[0][2]>=0?r[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],c=!1,d=0,m=l[0],f=r.length-1;for(let u=1;u<r.length;u++){let h=s&&u===f?r[u].slice(0,2):Jt(m.point,r[u],a);if(fr(m.point,h))continue;let E=Er(h,m.point);if(d+=E,u<f&&!c){if(d<i)continue;c=!0}m={point:h,pressure:r[u][2]>=0?r[u][2]:.5,vector:lo($(m.point,h)),distance:E,runningLength:d},l.push(m)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function co(e,t={}){return Pr(yr(e,t),t)}p();var wr=document.createElement("img");wr.src=`data:${ve.svg},${encodeURIComponent('<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="image" class="svg-inline--fa fa-image fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#888" d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"></path></svg>')}`;var Ir=document.createElement("img");Ir.src=`data:${ve.svg},${encodeURIComponent('<svg viewBox="0 0 668 668" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2"><path d="M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48ZM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56ZM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.81709 0 0 .81709 124.825 145.825)"/><path d="M256 8C119.034 8 8 119.033 8 256c0 136.967 111.034 248 248 248s248-111.034 248-248S392.967 8 256 8Zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676ZM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676Z" style="fill:#888;fill-rule:nonzero" transform="matrix(.30366 0 0 .30366 506.822 60.065)"/></svg>')}`;var po=new WeakMap;var Tr=new WeakMap([]);function mo(e){let t=Sr(e),n=new Path2D(t);return Tr.set(e,n),n}function Sr(e){let t=e.simulatePressure?e.points:e.points.length?e.points.map(([o,i],s)=>[o,i,e.pressures[s]]):[[0,0,.5]],n={simulatePressure:e.simulatePressure,size:e.strokeWidth*4.25,thinning:.6,smoothing:.5,streamline:.5,easing:o=>Math.sin(o*Math.PI/2),last:!!e.lastCommittedPoint};return Mr(co(t,n))}function uo(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}var Lr=/(\s?[A-Z]?,?-?[0-9]*\.[0-9]{0,2})(([0-9]|e|-)*)/g;function Mr(e){if(!e.length)return"";let t=e.length-1;return e.reduce((n,o,i,s)=>(i===t?n.push(o,uo(o,s[0]),"L",s[0],"Z"):n.push(o,uo(o,s[i+1])),n),["M",e[0],"Q"]).join(" ").replace(Lr,"$1")}var vr=e=>[8,8+e],go=e=>[1.5,6+e];function Ar(e){let t=e.roughness,n=Math.max(e.width,e.height),o=Math.min(e.width,e.height);return o>=20&&n>=50||o>=15&&e.roundness&&no(e.type)||le(e)&&n>=50?t:Math.min(t/(n<10?3:2),2.5)}var ne=(e,t=!1)=>{let n={seed:e.seed,strokeLineDash:e.strokeStyle==="dashed"?vr(e.strokeWidth):e.strokeStyle==="dotted"?go(e.strokeWidth):void 0,disableMultiStroke:e.strokeStyle!=="solid",strokeWidth:e.strokeStyle!=="solid"?e.strokeWidth+.5:e.strokeWidth,fillWeight:e.strokeWidth/2,hachureGap:e.strokeWidth*4,roughness:Ar(e),stroke:e.strokeColor,preserveVertices:t||e.roughness<Ct.cartoonist};switch(e.type){case"rectangle":case"iframe":case"embeddable":case"diamond":case"ellipse":return n.fillStyle=e.fillStyle,n.fill=ue(e.backgroundColor)?void 0:e.backgroundColor,e.type==="ellipse"&&(n.curveFitting=1),n;case"line":case"freedraw":return ze(e.points)&&(n.fillStyle=e.fillStyle,n.fill=e.backgroundColor==="transparent"?void 0:e.backgroundColor),n;case"arrow":return n;default:throw new Error(`Unimplemented type ${e.type}`)}},fo=(e,t,n)=>Wt(e)&&(t||On(e)&&n?.get(e.id)!==!0)&&ue(e.backgroundColor)&&ue(e.strokeColor)?{...e,roughness:0,backgroundColor:"#d3d3d3",fillStyle:"solid"}:Nn(e)?{...e,strokeColor:ue(e.strokeColor)?"#000000":e.strokeColor,backgroundColor:ue(e.backgroundColor)?"#f4f4f6":e.backgroundColor}:e,ho=(e,t,n,o,i,s,a)=>{let r=en(e,t,n,o);if(r===null)return[];let l=(c,d)=>{if(c===null)return[];let[,,m,f,u,h]=c;return[i.line(m,f,u,h,d)]};switch(o){case"dot":case"circle":case"circle_outline":{let[c,d,m]=r;return delete s.strokeLineDash,[i.circle(c,d,m,{...s,fill:o==="circle_outline"?a:e.strokeColor,fillStyle:"solid",stroke:e.strokeColor,roughness:Math.min(.5,s.roughness||0)})]}case"triangle":case"triangle_outline":{let[c,d,m,f,u,h]=r;return delete s.strokeLineDash,[i.polygon([[c,d],[m,f],[u,h],[c,d]],{...s,fill:o==="triangle_outline"?a:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,s.roughness||0)})]}case"diamond":case"diamond_outline":{let[c,d,m,f,u,h,E,P]=r;return delete s.strokeLineDash,[i.polygon([[c,d],[m,f],[u,h],[E,P],[c,d]],{...s,fill:o==="diamond_outline"?a:e.strokeColor,fillStyle:"solid",roughness:Math.min(1,s.roughness||0)})]}case"crowfoot_one":return l(r,s);case"bar":case"arrow":case"crowfoot_many":case"crowfoot_one_or_many":default:{let[c,d,m,f,u,h]=r;if(e.strokeStyle==="dotted"){let E=go(e.strokeWidth-1);s.strokeLineDash=[E[0],E[1]-1]}else delete s.strokeLineDash;return s.roughness=Math.min(1,s.roughness||0),[i.line(m,f,c,d,s),i.line(u,h,c,d,s),...o==="crowfoot_one_or_many"?l(en(e,t,n,"crowfoot_one"),s):[]]}}},Eo=(e,t,{isExporting:n,canvasBackgroundColor:o,embedsValidationStatus:i})=>{switch(e.type){case"rectangle":case"iframe":case"embeddable":{let s;if(e.roundness){let a=e.width,r=e.height,l=Se(Math.min(a,r),e);s=t.path(`M ${l} 0 L ${a-l} 0 Q ${a} 0, ${a} ${l} L ${a} ${r-l} Q ${a} ${r}, ${a-l} ${r} L ${l} ${r} Q 0 ${r}, 0 ${r-l} L 0 ${l} Q 0 0, ${l} 0`,ne(fo(e,n,i),!0))}else s=t.rectangle(0,0,e.width,e.height,ne(fo(e,n,i),!1));return s}case"diamond":{let s,[a,r,l,c,d,m,f,u]=$t(e);if(e.roundness){let h=Se(Math.abs(a-f),e),E=Se(Math.abs(c-r),e);s=t.path(`M ${a+h} ${r+E} L ${l-h} ${c-E}
            C ${l} ${c}, ${l} ${c}, ${l-h} ${c+E}
            L ${d+h} ${m-E}
            C ${d} ${m}, ${d} ${m}, ${d-h} ${m-E}
            L ${f+h} ${u+E}
            C ${f} ${u}, ${f} ${u}, ${f+h} ${u-E}
            L ${a-h} ${r+E}
            C ${a} ${r}, ${a} ${r}, ${a+h} ${r+E}`,ne(e,!0))}else s=t.polygon([[a,r],[l,c],[d,m],[f,u]],ne(e));return s}case"ellipse":return t.ellipse(e.width/2,e.height/2,e.width,e.height,ne(e));case"line":case"arrow":{let s,a=ne(e),r=e.points.length?e.points:[w(0,0)];if(He(e)?r.every(l=>Math.abs(l[0])<=1e6&&Math.abs(l[1])<=1e6)?s=[t.path(Cr(r,16),ne(e,!0))]:(console.error("Elbow arrow with extreme point positions detected. Arrow not rendered.",e.id,JSON.stringify(r)),s=[]):e.roundness?s=[t.curve(r,a)]:a.fill?s=[t.polygon(r,a)]:s=[t.linearPath(r,a)],e.type==="arrow"){let{startArrowhead:l=null,endArrowhead:c="arrow"}=e;if(l!==null){let d=ho(e,s,"start",l,t,a,o);s.push(...d)}if(c!==null){let d=ho(e,s,"end",c,t,a,o);s.push(...d)}}return s}case"freedraw":{let s;if(mo(e),ze(e.points)){let a=pt(e.points,.75);s=t.curve(a,{...ne(e),stroke:"none"})}else s=null;return s}case"frame":case"magicframe":case"text":case"image":return null;default:return Ft(e,`generateElementShape(): Unimplemented type ${e?.type}`),null}},Cr=(e,t)=>{let n=[];for(let i=1;i<e.length-1;i+=1){let s=e[i-1],a=e[i+1],r=e[i],l=xt(r,s),c=xt(a,r),d=Math.min(t,X(e[i],a)/2,X(e[i],s)/2);l?s[0]<r[0]?n.push([e[i][0]-d,e[i][1]]):n.push([e[i][0]+d,e[i][1]]):s[1]<r[1]?n.push([e[i][0],e[i][1]-d]):n.push([e[i][0],e[i][1]+d]),n.push(e[i]),c?a[0]<r[0]?n.push([e[i][0]-d,e[i][1]]):n.push([e[i][0]+d,e[i][1]]):a[1]<r[1]?n.push([e[i][0],e[i][1]-d]):n.push([e[i][0],e[i][1]+d])}let o=[`M ${e[0][0]} ${e[0][1]}`];for(let i=0;i<n.length;i+=3)o.push(`L ${n[i][0]} ${n[i][1]}`),o.push(`Q ${n[i+1][0]} ${n[i+1][1]}, ${n[i+2][0]} ${n[i+2][1]}`);return o.push(`L ${e[e.length-1][0]} ${e[e.length-1][1]}`),o.join(" ")};var xe=class e{static rg=new ge;static cache=new WeakMap;static get=t=>e.cache.get(t);static set=(t,n)=>e.cache.set(t,n);static delete=t=>e.cache.delete(t);static destroy=()=>{e.cache=new WeakMap};static generateElementShape=(t,n)=>{let o=n?.isExporting?void 0:e.get(t);if(o!==void 0)return o;po.delete(t);let i=Eo(t,e.rg,n||{isExporting:!1,canvasBackgroundColor:S.white,embedsValidationStatus:null});return e.cache.set(t,i),i}};var $t=e=>{let t=Math.floor(e.width/2)+1,n=0,o=e.width,i=Math.floor(e.height/2)+1,s=t,a=e.height;return[t,n,o,i,s,a,0,i]};var Dr=e=>{switch(e){case"arrow":return 25;case"diamond":case"diamond_outline":return 12;case"crowfoot_many":case"crowfoot_one":case"crowfoot_one_or_many":return 20;default:return 15}},Rr=e=>{switch(e){case"bar":return 90;case"arrow":return 20;default:return 25}},en=(e,t,n,o)=>{if(t.length<1)return null;let i=mt(t[0]);if(i.length<1)return null;let s=n==="start"?1:i.length-1,a=i[s].data;ie(a.length===6,"Op data length is not 6");let r=w(a[4],a[5]),l=w(a[2],a[3]),c=w(a[0],a[1]),d=i[s-1],m=w(0,0);if(d.op==="move"){let L=Dt(d.data);ie(L!=null,"Op data is not a point"),m=L}else d.op==="bcurveTo"&&(m=w(d.data[4],d.data[5]));let f=(L,D)=>Math.pow(1-L,3)*r[D]+3*L*Math.pow(1-L,2)*l[D]+3*Math.pow(L,2)*(1-L)*c[D]+m[D]*Math.pow(L,3),[u,h]=n==="start"?m:r,[E,P]=[f(.3,0),f(.3,1)],y=Math.hypot(u-E,h-P),I=(u-E)/y,H=(h-P)/y,J=Dr(o),C=0;{let[L,D]=n==="end"?e.points[e.points.length-1]:e.points[0],[b,v]=e.points.length>1?n==="end"?e.points[e.points.length-2]:e.points[1]:[0,0];C=Math.hypot(L-b,D-v)}let O=Math.min(J,C*(o==="diamond"||o==="diamond_outline"?.25:.5)),G=u-I*O,F=h-H*O;if(o==="dot"||o==="circle"||o==="circle_outline"){let L=Math.hypot(F-h,G-u)+e.strokeWidth-2;return[u,h,L]}let k=Rr(o);if(o==="crowfoot_many"||o==="crowfoot_one_or_many"){let[L,D]=_(w(u,h),w(G,F),Ce(-k)),[b,v]=_(w(u,h),w(G,F),Ce(k));return[G,F,L,D,b,v]}let[z,N]=_(w(G,F),w(u,h),-k*Math.PI/180),[T,B]=_(w(G,F),w(u,h),Ce(k));if(o==="diamond"||o==="diamond_outline"){let L,D;if(n==="start"){let[b,v]=e.points.length>1?e.points[1]:[0,0];[L,D]=_(w(u+O*2,h),w(u,h),Math.atan2(v-h,b-u))}else{let[b,v]=e.points.length>1?e.points[e.points.length-2]:[0,0];[L,D]=_(w(u-O*2,h),w(u,h),Math.atan2(h-v,u-b))}return[u,h,z,N,L,D,T,B]}return[u,h,z,N,T,B]};var xo=e=>le(e)||ke(e)?e.points.length<2:e.width===0&&e.height===0;var jh=e=>e.reduce((t,n)=>t+n.version,0),qh=e=>{let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e[n].versionNonce;return t>>>0},Zh=e=>{let t=5381;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);t=(t<<5)+t+o}return t>>>0},Qh=e=>e.filter(t=>!t.isDeleted&&!xo(t)),Br=e=>e.filter(t=>!t.isDeleted),ur=e=>!e.isDeleted,tn=e=>Br(e).map(t=>Xt(t.type)?{...t,lastCommittedPoint:null}:t),Jh=e=>tn(e),eg=e=>tn(e),tg=e=>tn(e);export{Jh as clearElementsForDatabase,eg as clearElementsForExport,tg as clearElementsForLocalStorage,Br as getNonDeletedElements,jh as getSceneVersion,Qh as getVisibleElements,qh as hashElementsVersion,Zh as hashString,ur as isNonDeletedElement};
